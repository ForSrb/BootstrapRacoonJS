<ng-container *ngIf="loading$ | async; else noLoading">
  <bootstrapbugz-loader></bootstrapbugz-loader>
</ng-container>
<ng-template #noLoading>
  <mat-card>
    <mat-card-content>
      <form (ngSubmit)="onProfileUpdate()" [formGroup]="updateProfileForm">
        <h2>Update Profile</h2>
        <mat-form-field appearance="outline">
          <mat-label>First Name</mat-label>
          <input formControlName="firstName" matInput type="text" />
          <mat-error *ngIf="updateProfileForm.controls.firstName.errors?.required">
            First name is required.
          </mat-error>
          <mat-error *ngIf="updateProfileForm.controls.firstName.errors?.pattern">
            Invalid first name.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Last Name</mat-label>
          <input formControlName="lastName" matInput type="text" />
          <mat-error *ngIf="updateProfileForm.controls.lastName.errors?.required">
            Last name is required.
          </mat-error>
          <mat-error *ngIf="updateProfileForm.controls.lastName.errors?.pattern">
            Invalid last name.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Username</mat-label>
          <input formControlName="username" matInput type="text" />
          <mat-error *ngIf="updateProfileForm.controls.username.errors?.required">
            Username is required.
          </mat-error>
          <mat-error *ngIf="updateProfileForm.controls.username.errors?.pattern">
            Invalid username.
          </mat-error>
          <mat-error *ngIf="updateProfileForm.controls.username.errors?.nonUniqueUsername">
            Username taken.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input formControlName="email" matInput type="email" />
          <mat-error *ngIf="updateProfileForm.controls.email.errors?.required">
            Email is required.
          </mat-error>
          <mat-error *ngIf="updateProfileForm.controls.email.errors?.email">
            Invalid email.</mat-error
          >
          <mat-error *ngIf="updateProfileForm.controls.email.errors?.nonUniqueEmail">
            Email taken.
          </mat-error>
        </mat-form-field>
        <button color="primary" mat-raised-button type="submit">Update Profile</button>
      </form>
    </mat-card-content>
  </mat-card>
  <mat-card>
    <mat-card-content>
      <form (ngSubmit)="onPasswordChange()" [formGroup]="changePasswordForm">
        <h2>Change Password</h2>
        <mat-form-field appearance="outline">
          <mat-label>Old Password</mat-label>
          <input formControlName="oldPassword" matInput type="password" />
          <mat-error *ngIf="changePasswordForm.controls.oldPassword.errors?.required">
            Old password is required.
          </mat-error>
          <mat-error *ngIf="changePasswordForm.controls.oldPassword.errors?.pattern">
            Invalid old password.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Password</mat-label>
          <input formControlName="password" matInput type="password" />
          <mat-error *ngIf="changePasswordForm.controls.password.errors?.required">
            Password is required.
          </mat-error>
          <mat-error *ngIf="changePasswordForm.controls.password.errors?.pattern">
            Invalid password.
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Confirm Password</mat-label>
          <input formControlName="confirmPassword" matInput type="password" />
          <mat-error *ngIf="changePasswordForm.controls.confirmPassword.errors?.required">
            Confirm password is required.
          </mat-error>
          <mat-error *ngIf="changePasswordForm.controls.confirmPassword.errors?.pattern">
            Invalid confirm password.
          </mat-error>
        </mat-form-field>
        <mat-error
          *ngIf="
            changePasswordForm.controls.password.touched &&
            changePasswordForm.controls.confirmPassword.touched &&
            changePasswordForm.hasError('passwordsDoNotMatch')
          "
        >
          Passwords do not match.
        </mat-error>
        <button color="primary" mat-raised-button type="submit">Change Password</button>
      </form>
    </mat-card-content>
  </mat-card>
  <mat-card>
    <mat-card-content>
      <button
        color="primary"
        mat-raised-button
        type="submit"
        routerLink="/auth/sign-out-from-all-devices"
      >
        Sign Out From All Devices
      </button>
    </mat-card-content>
  </mat-card>
</ng-template>
